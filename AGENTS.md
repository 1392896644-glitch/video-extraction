## 项目概述
- **名称**: 视频文案提取工作流
- **功能**: 从视频中提取文案，生成摘要，进行文案分析（痛点、人群画像），生成5条不同风格的二创改写（品牌名称统一改为"立时"），并将结果整理到飞书多维表格中

### 节点清单
| 节点名 | 文件位置 | 类型 | 功能描述 | 分支逻辑 | 配置文件 |
|-------|---------|------|---------|---------|---------|
| video_text_extraction | `nodes/video_text_extraction_node.py` | agent | 从视频中提取文案内容 | - | `config/video_text_extraction_cfg.json` |
| text_summary | `nodes/text_summary_node.py` | agent | 对提取的文案生成摘要 | - | `config/text_summary_cfg.json` |
| text_analysis | `nodes/text_analysis_node.py` | agent | 深入分析文案的痛点、人群画像和成功原因 | - | `config/text_analysis_cfg.json` |
| text_rewrite | `nodes/text_rewrite_node.py` | agent | 生成5条不同风格的改写文案，品牌改为"立时" | - | `config/text_rewrite_cfg.json` |
| feishu_doc_write | `nodes/feishu_doc_write_node.py` | task | 将文案、摘要、分析和5条改写写入飞书多维表格（内存优化版） | - | - |

**类型说明**: task(task节点) / agent(大模型) / condition(条件分支) / looparray(列表循环) / loopcond(条件循环)

## 技能使用
- 节点`video_text_extraction`、`text_summary`、`text_analysis`、`text_rewrite`使用大语言模型技能（LLM）
- 节点`feishu_doc_write`使用飞书多维表格技能

## 工作流说明
1. **视频文案提取**: 使用多模态大模型（doubao-seed-1-6-vision-250815）分析上传的视频文件，提取画面中的文案
   - 支持上传视频文件（.mp4、.mov、.avi、.flv、.webm等格式）
   - 支持本地文件和对象存储URL
   - 自动识别视频中所有文字内容
2. **文案摘要生成**: 使用大模型（doubao-seed-1-8-251228）对提取的文案进行分析，生成摘要
3. **文案分析**: 使用大模型（doubao-seed-1-8-251228）深入分析文案，包括：
   - 用户痛点分析：识别文案中提及的用户痛点和问题
   - 人群画像分析：描述目标用户群体的基本特征、心理需求和生活场景
   - 成功原因分析：分析文案的语言风格、情感调动、转化逻辑和核心成功因素
4. **文案改写**: 使用大模型（doubao-seed-1-8-251228）生成5条不同风格的改写文案，品牌名称统一改为"立时"：
   - 改写1：痛点直击型 - 直接点明用户痛点，快速引起共鸣
   - 改写2：情感共鸣型 - 用情感化语言，触动用户内心
   - 改写3：数据说服型 - 用具体数据和事实说话，增强可信度
   - 改写4：场景化描述型 - 描述具体使用场景，让用户身临其境
   - 改写5：简洁有力型 - 用简洁有力的语言，直击核心
5. **飞书文档写入**: 将文案、摘要、分析和5条改写内容写入飞书多维表格，包含8个字段：
   - 提取文案信息
   - 提取文案信息_摘要_
   - 文案分析
   - 文案改写1_痛点直击型
   - 文案改写2_情感共鸣型
   - 文案改写3_数据说服型
   - 文案改写4_场景化描述型
   - 文案改写5_简洁有力型

## 执行顺序（内存优化）
为了适配低内存环境（如Render免费版512MB），工作流采用串行执行顺序：
1. 视频文案提取 → 2. 文案摘要生成 → 3. 文案分析 → 4. 文案改写 → 5. 飞书文档写入

这样可以显著降低内存峰值，避免内存不足导致的进程被杀掉问题。

飞书文档写入节点经过内存优化：
- 延迟初始化飞书客户端和凭证
- 限制字段长度（文案2000字符，摘要1000字符）
- 不存储中间变量，直接写入飞书

## 视频文件上传说明

### 支持的视频格式
- 视频格式：mp4, mov, avi, flv, webm, mkv等
- 视频大小：建议小于500MB，确保处理速度
- 视频时长：建议小于10分钟，避免处理时间过长

### 上传方式
1. **直接上传本地视频文件**
   - 从电脑或手机选择视频文件上传
   - 系统会自动处理并提取文案

2. **使用对象存储URL**
   - 将视频上传到对象存储（阿里云OSS、腾讯云COS等）
   - 获取公共访问URL
   - 直接输入URL即可处理

### 对象存储配置建议

**阿里云OSS：**
1. 创建Bucket，设置为公共读
2. 上传视频文件
3. 获取文件URL
4. 使用URL进行文案提取

**腾讯云COS：**
1. 创建存储桶，设置为公有读
2. 上传视频文件
3. 获取访问链接
4. 使用链接进行文案提取

**注意事项：**
- 对象存储URL必须是公开可访问的（不需要鉴权）
- 推荐视频格式：mp4（兼容性最好）
- 视频大小建议小于100MB，确保处理速度
